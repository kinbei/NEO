## 代码规范
* 函数注释规范,统一采用     
```lua
--[[
-- 注释内容
--]]
```

* 如果在一个 `lua` 文件内使用一个`结构`(注意: 这个结构只有这个文件才使用到), 那么必须注释说明这个`结构`的内容    
```lua
-- 下面注意很清晰看到 tbl_cache 这个 table 中, activity_type 作为 key, 
-- value 存放着一个结构, 结构里包含这两个字段, 分别是 activity_id 和 activity_name 
tbl_cache = {} -- = { [activity_type] = {{activity_id = xx, activity_name = xx}, ...} }
```

* 所有Log必须有`模块名`, `方法名`, 并尽量加上 `player_id`, 方便具体玩家问题的定位      
```lua
-- 示例
-- gw_task_oper 表示模块名
-- submit 表示模块方法名
-- player_id, task_id 相关参数
-- cant found task id 为具体的错误信息
log_error("gw_task_oper|submit|player_id(%d)|task_id(%d)|cant found task id", player_id, task_id)
```
* 不要在服务器代码中返回文字给客户端      
(1) 错误信息必须通过`错误码`通知客户端       
(2) `公告`, `系统邮件` 内容统一由策划配置在 `server_language_cn` 配置表中      
(3) `server_language_cn` 中一条记录包含 `lang_type`, `lang_id` 和 `lang_str` 三个字段      
(4) `lang_type` 表示模块名, `lang_id` 表示模块内标识, `lang_str` 表示具体的文字信息       

* 除了枚举/全局变量, 其它变量一律小写下划线分隔形式     
注: 常量的定义,及引入常量的变量大写     
```lua
-- 正确示例
local retcode = ERRCODE.GWERR_NO_GOLD

-- 错误示例
local retcode = errcode.GWERR_NO_GOLD
```

* 如果需要在多于一个 `lua` 文件中传递一个 `结构`, 那么这个 `结构` 需要定义    
注: 在 `deploy\common\netimpl\common\` 目录下增加对应的`结构`定义文件
```lua
local network = require("network")

local function response_serial(self, buffer)
	network.writenumber(buffer, self.activity_id)
	network.writenumber(buffer, self.player_id)
end

local function response_unserial(self, buffer)
	self.activity_id = network.readnumber(buffer)
	self.player_id = network.readnumber(buffer)
end

local protocol = {}
function protocol.create_request()
	error("not implemented")
end

function protocol.create_response()
	local response = {}
	response.activity_id = 0
	response.player_id = 0

	response.serial = response_serial
	response.unserial = response_unserial
	return response
end

return protocol
```   

* 如果一个`table`是一个`序列`或`hash table`, 变量命令必须以`tbl_` 开头
```lua
-- 示例
-- local tbl_player = {}
```

* 变量名禁用 `..` 字符串连接用法
```lua
-- 错误示例
USE_TYPE = {
  [1] = 'GOLD',
  [2] = 'DIAMOND',
  [3] = 'STAMINA',
  [4] = 'ITEM',
  [5] = 'SOUL',
  [6] = 'GUILD_CONTRIBUTE',
}
resp.retcode = ERRCODE['GWERR_NO_' .. USE_TYPE[cost_type]]

-- 正确示例
resp.retcode = ERRCODE.GWERR_NO_SOUL
```

* Lua中字符串允许用单引号或双引号括起来, 服务器统一用双引号       
```lua
-- 错误示例
log_debug('test')

-- 正确示例
log_debug("test")
```

